"use strict";(self.webpackChunklearning_threejs_baz=self.webpackChunklearning_threejs_baz||[]).push([[826],{479:(t,e,s)=>{var a=s(212),i=s(79),o=s(11),r=s(365);class n{constructor(){this.initComponents(),this.bindEvents()}initComponents(){this.el=document.querySelector("[data-loading-screen]")}bindEvents(){this.el.addEventListener("transitionend",this.destroy.bind(this))}hide(){this.el.classList.add("fade-out")}destroy(){this.el.remove()}}class h{constructor(t,e){this.objLoader=t,this.textureLoader=e,this.materials={},this.rootObject=null,this.pickableMeshes=[],this.step=0,this.initMaterials(),this.initGeo()}initMaterials(){this.materials.toaster=new a.Wid({normalMap:this.textureLoader.load("models/toaster/textures/v2/jpg/toaster_low_material_Normal.jpg"),metalnessMap:this.textureLoader.load("models/toaster/textures/v2/jpg/toaster_low_material_Metallic.jpg"),metalness:1,roughnessMap:this.textureLoader.load("models/toaster/textures/v2/jpg/toaster_low_material_Roughness.jpg"),aoMap:this.textureLoader.load("models/toaster/textures/v2/jpg/toaster_low_material_Occlusion.jpg"),aoMapIntensity:.75,map:this.textureLoader.load("models/toaster/textures/v2/jpg/toaster_low_material_BaseColor.jpg")}),this.materials.toaster.map.encoding=a.knz,this.materials.toasterBody=this.materials.toaster.clone(),this.materials.toasterBody.roughness=1.05,this.materials.toasterBody.color.setStyle("#d3e4e6")}initGeo(){this.rootObject=new a.ZAu,this.rootObject.name="toaster",this.objLoader.load("models/toaster/toaster.obj",(t=>{const e=t.children[0];e.geometry.attributes.uv2=e.geometry.attributes.uv,e.castShadow=!0,e.receiveShadow=!0,e.material=this.materials.toaster,this.pickableMeshes.push(e),this.rootObject.add(e)})),this.objLoader.load("models/toaster/toaster_body.obj",(t=>{const e=t.children[0];e.geometry.attributes.uv2=e.geometry.attributes.uv,e.castShadow=!0,e.receiveShadow=!0,e.material=this.materials.toasterBody,this.pickableMeshes.push(e),this.rootObject.add(e)}))}update(){this.step+=.05,this.rootObject.position.y=.15*Math.sin(this.step)}}class d{constructor(t){this.textureLoader=t,this.materials={},this.rootObject=null,this.pickableMeshes=[],this.initMaterials(),this.initGeo()}initMaterials(){this.materials.shadowMaterial=new a.Tn7({opacity:.6})}initGeo(){const t=new a._12(500,500);t.rotateX(-Math.PI/2),this.rootObject=new a.Kj0(t,this.materials.shadowMaterial),this.rootObject.name="shadow-catcher",this.rootObject.position.y=-38,this.rootObject.receiveShadow=!0}update(){}}class c{constructor(t,e,s){this.scene=t,this.textureLoader=e,this.gizmo=s,this.environmentMap(),this.createLight(t,0,a.M8C.degToRad(0),1e4,!0),this.createLight(t,1.41,1.35,2e4),this.createLight(t,.6,1.15,3e4),this.createLight(t,-.43,1.09,2e4),this.createLight(t,-1.2,1.3,4e4),this.createLight(t,-2.6,1.1,3e4),this.createLight(t,-2.99,.87,4e4),this.createLight(t,2.1,.78,4e4)}environmentMap(){this.textureLoader.load("environments/CT-office-2k-sharper-90.webp",(t=>{t.mapping=a.dSO,t.encoding=a.knz,this.scene.environment=t}))}createLight(t,e,s,i,o,r){const n=new a.ZAu;n.rotateY(e),t.add(n);const h=new a.ZAu;h.rotateX(s),n.add(h);const d=new a.ZAu;d.position.set(0,500,0),h.add(d);const c=new a.PMe;c.color=new a.Ilk("rgb(255, 245, 200)"),c.intensity=i,c.decay=2,c.angle=.3,o&&(c.castShadow=!0,c.shadow.camera.near=400,c.shadow.camera.far=600,c.shadow.focus=1.3),d.add(c),r&&(n.name="pivotRotate",h.name="pivotHeight",d.name="lightArm",c.name="spotLight1",r.attach(h),r.setMode("rotate"),r.setSpace("local"),t.add(r),this.spotLightHelper=new a.FvO(c),t.add(this.spotLightHelper),this.shadowHelper=new a.Rki(c.shadow.camera),t.add(this.shadowHelper))}update(){this.spotLightHelper&&this.spotLightHelper.update(),this.shadowHelper&&this.shadowHelper.update()}}class l{constructor(t){this.materials=t,this.initComponents(),this.bindEvents()}initComponents(){this.el=document.querySelector("[data-color-picker]"),this.swatches=document.querySelectorAll("[data-swatch]")}bindEvents(){this.swatches.forEach((t=>{t.addEventListener("click",(e=>{const s=t.dataset.swatch;this.materials.toasterBody.color.setStyle(s),"#d3e4e6"==s?(this.materials.toasterBody.metalness=1,this.materials.toasterBody.roughness=1.05):(this.materials.toasterBody.metalness=.05,this.materials.toasterBody.roughness=1.2)}))}))}show(){this.el.classList.remove("hidden"),this.swatches.forEach((t=>{t.classList.add("appear")}))}}const p=function(t){var e=new i.Z;return e.showPanel(0),document.body.appendChild(e.dom),e}(),m=function(t){const e=new a.CP7({powerPreference:"high-performance",alpha:!0});return e.setSize(window.innerWidth,window.innerHeight),e.shadowMap.enabled=!0,e.shadowMapSoft=!0,e.shadowMap.type=a.ntZ,e.physicallyCorrectLights=!0,e.toneMapping=a.LY2,e.gammaFactor=2.2,e.outputEncoding=a.knz,document.getElementById("webgl-output").appendChild(e.domElement),e}(),u=function(t){var e=void 0!==t?t:new a.Pa4(0,22,50),s=new a.cPb(45,window.innerWidth/window.innerHeight,1,1e3);return s.position.copy(e),s.lookAt(new a.Pa4(0,0,0)),s}(new a.Pa4(-20,22,62)),w=new class{constructor(t,e){this.renderer=t,this.camera=e,this.scene=new a.xsS,this.loadingManager=new a.lLk,this.materials={},this.pickableMeshes=[],this.objLoader=new o.L(this.loadingManager),this.objLoader.setPath("assets/"),this.textureLoader=new a.dpR(this.loadingManager),this.textureLoader.setPath("assets/"),this.orbitControls=this.initControls(),this.addObjects(),this.lights=new c(this.scene,this.textureLoader),this.initComponents(),this.bindEvents()}initControls(){const t=new r.z(this.camera,this.renderer.domElement);return t.enablePan=!1,t.minPolarAngle=a.M8C.degToRad(30),t.maxPolarAngle=a.M8C.degToRad(120),t.autoRotate=!0,t.enableDamping=!0,t}addObjects(){this.toaster=new h(this.objLoader,this.textureLoader),this.scene.add(this.toaster.rootObject),this.shadowCatcher=new d(this.textureLoader),this.scene.add(this.shadowCatcher.rootObject)}initComponents(){this.loadingScreen=new n,this.colourPicker=new l(this.toaster.materials)}bindEvents(){this.loadingManager.onLoad=this.onLoad.bind(this)}onLoad(){this.fitCameraToSelection(this.camera,this.orbitControls,this.toaster.rootObject.children),this.loadingScreen.hide(),this.colourPicker.show()}update(){this.orbitControls.update(),this.toaster.update()}fitCameraToSelection(t,e,s,i=1.1){const o=new a.ZzF;for(const t of s)o.expandByObject(t);const r=o.getSize(new a.Pa4),n=o.getCenter(new a.Pa4),h=Math.max(r.x,r.y,r.z)/(2*Math.atan(Math.PI*t.fov/360)),d=h/t.aspect,c=i*Math.max(h,d),l=e.target.clone().sub(t.position).normalize().multiplyScalar(c);e.minDistance=c/2,e.maxDistance=3*c,e.target.copy(n),e.target.y=-4,t.near=c/100,t.far=100*c,t.updateProjectionMatrix(),t.position.copy(e.target).sub(l),e.update()}}(m,u);window.addEventListener("resize",(function(){u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),m.setSize(window.innerWidth,window.innerHeight)}),!1),function t(){p.update(),w.update(),m.render(w.scene,u),window.requestAnimationFrame(t)}()}},t=>{t.O(0,[813],(()=>(479,t(t.s=479)))),t.O()}]);